In this article, we will introduce how to issue a test report with code coverage.

Generally, we can see the test results in the test explorer of vs. You can also use Enterprise vs to analyze code coverage, but this is not our recommended practice.We hope to integrate test reports into the CI / CD process to ensure code quality.

Therefore, we have explored some cross platform methods to issue test reports for your reference.

# Output to console by coverlet.msbuild
When we need to print the test report with `Code Coverage` in the console, we can first add the nuget package of `convertlet.msbuild`:
```
dotnet add package coverlet.msbuild
```
Then execute the test command:
```
dotnet test /p:CollectCoverage=true
```
The test coverage report can be printed on the console:
![image.png](/.attachments/image-5dac9826-b214-4489-bdff-1cdc19952644.png)

The test report generated by msbuild will contain macro test results and code coverage. When you need to know which code has been covered or has not been covered by test cases, you need to use the following package.

# Generate test report by coverlet.collector
The `coverlet.collector` package should have been included in your xUnit project. If it has not been referenced, you can add the corresponding nuget package dependency:
```
dotnet add package coverlet.collector
```
Then execute the following command in the xUnit project:
```
dotnet test --collect:"XPlat Code Coverage"
```
After execution, you will find an additional folder called `testresults` in the project, which is the result of this code measurement:
![image.png](/.attachments/image-f4b1a674-63a1-4d33-a8b0-eb6a2422f1b5.png)

However, because the report is in XML format, in order to facilitate reading, we have introduced the package dependency of `ReportGenerator`.

The `ReportGenerator` provides several ways to use it, one is to use it through the nuget package, and the other is to install it as a global command-line instruction tool. Here we choose the second.

Execute the following command to install globally:
```
dotnet tool install --global dotnet-reportgenerator-globaltool
```
Then you can use it to generate the report. Execute the following code in the xUnit test project:
```
reportgenerator "-reports:**\coverage.cobertura.xml" "-targetdir:coveragereport"
```
The meaning of this command is: generate a report according to the `coverage.cobertura.xml` file under the xUnit project, and the output directory is `coveragereport`.

![image.png](/.attachments/image-3135f3f7-c810-4ca4-803f-da650876cd15.png)

After execution, a folder named `coveragereport` will appear in the directory, which contains the web page generated by the test report.
![image.png](/.attachments/image-a68b5a21-b6da-4752-bee3-a3e10d4eba1c.png)

Click index.html to open the web page, and we can see a very detailed test report.
![image.png](/.attachments/image-4c317c86-c313-476d-8905-5f97090ae64c.png)
Click the source file to view the detailed test coverage.
![image.png](/.attachments/image-c8b327b8-89d8-4116-a34e-6742b9b5bb8d.png)
![image.png](/.attachments/image-98d1ae2d-5b4e-41a0-ada3-219fde55abe1.png)

# Generate report and output to console
We can use `msbuild` and `Collector` together:
```
dotnet test /p:CollectCoverage=true --collect:"XPlat Code Coverage"
```
Then use the `ReportGenerator` to generate HTML reports based on XML
```
reportgenerator "-reports:**\coverage.cobertura.xml" "-targetdir:coveragereport"
```

